"use strict";function initMaps(){map=new google.maps.Map(document.getElementById("map"),{zoom:15,center:{lat:55.752371,lng:37.592595}});var o=[{lat:55.758194,lng:37.584223},{lat:55.754255,lng:37.605706},{lat:55.756332,lng:37.607122},{lat:55.754758,lng:37.611958},{lat:55.749352,lng:37.608452},{lat:55.750584,lng:37.604032},{lat:55.748821,lng:37.602573},{lat:55.747299,lng:37.599011},{lat:55.746478,lng:37.585621},{lat:55.744304,lng:37.587166},{lat:55.743917,lng:37.583519},{lat:55.745463,lng:37.582832},{lat:55.745608,lng:37.573906},{lat:55.752861,lng:37.574065},{lat:55.755318,lng:37.57648},{lat:55.755463,lng:37.583561}];districtArbat=new google.maps.Polygon({paths:o}),districtArbat.setMap(map),fetch("http://gwctest.org/bars/get").then(function(o){if(200!==o.status)return void console.log("Looks like there was a problem. Status Code: "+o.status);o.json().then(function(o){setMarkers(o),console.log(count),document.getElementById("count").innerHTML=count,console.log(JSON.stringify(array))})}).catch(function(o){console.log("Fetch Error :-S",o)})}function setMarkers(o){o.forEach(function(o){var r=new google.maps.LatLng(parseFloat(o.lat),parseFloat(o.long));if(google.maps.geometry.poly.containsLocation(r,districtArbat)){var e=new google.maps.Marker({position:r,map:map,title:o.name});count++;var s='<div class="col-md-4 place"><div class="place-wrap"><div class="title">'+o.name+'</div><div class="coords">Координаты: '+o.lat+","+o.long+'</div><div class="phone">'+o.phone+'</div><div class="phone">'+o.address+'</div><div class="phone">Рейтинг: '+o.rating+'</div><div class="phone">Отзывов: '+o.reviews+'</div><div class="website"><a href="http://'+o.website+'">'+o.website+'</a></div><div class="schedule">'+parseWeeksHTML(o.schedule)+"</div></div></div>",n='<div class="place"><div class="place-wrap"><div class="title">'+o.name+'</div><div class="coords">Координаты: '+o.lat+","+o.long+'</div><div class="phone">'+o.phone+'</div><div class="phone">'+o.address+'</div><div class="phone">Рейтинг: '+o.rating+'</div><div class="phone">Отзывов: '+o.reviews+'</div><div class="website"><a href="http://'+o.website+'">'+o.website+'</a></div><div class="schedule">'+parseWeeksHTML(o.schedule)+"</div></div></div>",i=new google.maps.InfoWindow({content:n});e.addListener("click",function(){i.open(map,e)}),document.getElementById("places").innerHTML+=s,array.push({"Название":o.name,Lat:o.lat,Long:o.long,"Адрес":o.address,"Телефон":o.phone,"Сайт":o.website,"Расписание":parseWeeks(o.schedule)})}})}function parseWeeks(o){var r="",e=JSON.parse(o);return void 0!==e.Mon&&(r+="Понедельник: "+e.Mon.working_hours[0].from+"-"+e.Mon.working_hours[0].to+". "),void 0!==e.Tue&&(r+="Вторник: "+e.Tue.working_hours[0].from+"-"+e.Tue.working_hours[0].to+". "),void 0!==e.Wed&&(r+="Среда: "+e.Wed.working_hours[0].from+"-"+e.Wed.working_hours[0].to+". "),void 0!==e.Thu&&(r+="Четверг: "+e.Thu.working_hours[0].from+"-"+e.Thu.working_hours[0].to+". "),void 0!==e.Fri&&(r+="Пятница: "+e.Fri.working_hours[0].from+"-"+e.Fri.working_hours[0].to+". "),void 0!==e.Sat&&(r+="Суббота: "+e.Sat.working_hours[0].from+"-"+e.Sat.working_hours[0].to+". "),void 0!==e.Sun&&(r+="Воскресенье: "+e.Sun.working_hours[0].from+"-"+e.Sun.working_hours[0].to+". "),r}function parseWeeksHTML(o){var r="<br>",e=JSON.parse(o);return void 0!==e.Mon&&(r+="Понедельник: "+e.Mon.working_hours[0].from+"-"+e.Mon.working_hours[0].to+".<br>"),void 0!==e.Tue&&(r+="Вторник: "+e.Tue.working_hours[0].from+"-"+e.Tue.working_hours[0].to+".<br>"),void 0!==e.Wed&&(r+="Среда: "+e.Wed.working_hours[0].from+"-"+e.Wed.working_hours[0].to+".<br>"),void 0!==e.Thu&&(r+="Четверг: "+e.Thu.working_hours[0].from+"-"+e.Thu.working_hours[0].to+".<br>"),void 0!==e.Fri&&(r+="Пятница: "+e.Fri.working_hours[0].from+"-"+e.Fri.working_hours[0].to+".<br>"),void 0!==e.Sat&&(r+="Суббота: "+e.Sat.working_hours[0].from+"-"+e.Sat.working_hours[0].to+".<br>"),void 0!==e.Sun&&(r+="Воскресенье: "+e.Sun.working_hours[0].from+"-"+e.Sun.working_hours[0].to+".<br>"),r}var map,districtArbat,array=[],count=0;